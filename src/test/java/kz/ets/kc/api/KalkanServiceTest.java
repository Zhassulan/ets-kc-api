package kz.ets.kc.api;

import kz.ets.kc.api.kalkan.KalkanService;
import kz.ets.kc.api.rest.model.CMSDataVerifyRequest;
import lombok.extern.slf4j.Slf4j;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.ActiveProfiles;
import org.springframework.test.context.junit4.SpringRunner;

import static org.junit.jupiter.api.Assertions.assertTrue;

@RunWith(SpringRunner.class)
@SpringBootTest
@ActiveProfiles("dev")
@Slf4j
public class KalkanServiceTest {

    @Autowired
    KalkanService kalkanService;

    @Test
    public void verifySign() {
        var req = new CMSDataVerifyRequest(
                "KORD",
                "bXlzcWxpLm1heF9wZXJzaXN0ZW50ID0gLTEKCjsgQWxsb3cgYWNjZXNzaW5nLCBmcm9tIFBIUCdzIHBlcnNwZWN0aXZlLCBsb2NhbCBmaWxlcyB3aXRoIExPQUQgREFUQSBzdGF0ZW1lbnRzCjsgaHR0cDovL3BocC5uZXQvbXlzcWxpLmFsbG93X2xvY2FsX2luZmlsZQo7bXlzcWxpLmFsbG93X2xvY2FsX2luZmlsZSA9IE9uCgo7IEFsbG93IG9yIHByZXZlbnQgcGVyc2lzdGVudCBsaW5rcy4KOyBodHRwOi8vcGhwLm5ldC9teXNxbGkuYWxsb3ctcGVyc2lzdGVudApteXNxbGkuYWxsb3dfcGVyc2lzdGVudCA9IE9uCgo7IE1heGltdW0gbnVtYmVyIG9mIGxpbmtzLiAgLTEgbWVhbnMgbm8gbGltaXQuCjsgaHR0cDovL3BocC5uZXQvbXlzcWxpLm1heC1saW5rcwpteXNxbGkubWF4X2xpbmtzID0gLTEKCjsgSWYgbXlzcWxuZCBpcyB1c2VkOiBOdW1iZXIgb2YgY2FjaGUgc2xvdHMgZm9yIHRoZSBpbnRlcm5hbCByZXN1bHQgc2V0IGNhY2hlCjsgaHR0cDovL3BocC5uZXQvbXlzcWxpLmNhY2hlX3NpemUKbXlzcWxpLmNhY2hlX3NpemUgPSAyMDAwCgo7IERlZmF1bHQgcG9ydCBudW1iZXIgZm9yIG15c3FsaV9jb25uZWN0KCkuICBJZiB1bnNldCwgbXlzcWxpX2Nvbm5lY3QoKSB3aWxsIHVzZQo7IHRoZSAkTVlTUUxfVENQX1BPUlQgb3IgdGhlIG15c3FsLXRjcCBlbnRyeSBpbiAvZXRjL3NlcnZpY2VzIG9yIHRoZQo7IGNvbXBpbGUtdGltZSB2YWx1ZSBkZWZpbmVkIE1ZU1FMX1BPUlQgKGluIHRoYXQgb3JkZXIpLiAgV2luMzIgd2lsbCBvbmx5IGxvb2sKOyBhdCBNWVNRTF9QT1JULgo7IGh0dHA6Ly9waHAubmV0L215c3FsaS5kZWZhdWx0LXBvcnQ=",
                "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");
        try {
            kalkanService.verifyCMSSignature(req);
            assertTrue(true == true);
        } catch (Exception e) {
            assertTrue(true == false);
            log.error("error: ", e);
        }
    }

    @Test
    public void certInfo() {
        var req = new CMSDataVerifyRequest(
                "KORD",
                "bXlzcWxpLm1heF9wZXJzaXN0ZW50ID0gLTEKCjsgQWxsb3cgYWNjZXNzaW5nLCBmcm9tIFBIUCdzIHBlcnNwZWN0aXZlLCBsb2NhbCBmaWxlcyB3aXRoIExPQUQgREFUQSBzdGF0ZW1lbnRzCjsgaHR0cDovL3BocC5uZXQvbXlzcWxpLmFsbG93X2xvY2FsX2luZmlsZQo7bXlzcWxpLmFsbG93X2xvY2FsX2luZmlsZSA9IE9uCgo7IEFsbG93IG9yIHByZXZlbnQgcGVyc2lzdGVudCBsaW5rcy4KOyBodHRwOi8vcGhwLm5ldC9teXNxbGkuYWxsb3ctcGVyc2lzdGVudApteXNxbGkuYWxsb3dfcGVyc2lzdGVudCA9IE9uCgo7IE1heGltdW0gbnVtYmVyIG9mIGxpbmtzLiAgLTEgbWVhbnMgbm8gbGltaXQuCjsgaHR0cDovL3BocC5uZXQvbXlzcWxpLm1heC1saW5rcwpteXNxbGkubWF4X2xpbmtzID0gLTEKCjsgSWYgbXlzcWxuZCBpcyB1c2VkOiBOdW1iZXIgb2YgY2FjaGUgc2xvdHMgZm9yIHRoZSBpbnRlcm5hbCByZXN1bHQgc2V0IGNhY2hlCjsgaHR0cDovL3BocC5uZXQvbXlzcWxpLmNhY2hlX3NpemUKbXlzcWxpLmNhY2hlX3NpemUgPSAyMDAwCgo7IERlZmF1bHQgcG9ydCBudW1iZXIgZm9yIG15c3FsaV9jb25uZWN0KCkuICBJZiB1bnNldCwgbXlzcWxpX2Nvbm5lY3QoKSB3aWxsIHVzZQo7IHRoZSAkTVlTUUxfVENQX1BPUlQgb3IgdGhlIG15c3FsLXRjcCBlbnRyeSBpbiAvZXRjL3NlcnZpY2VzIG9yIHRoZQo7IGNvbXBpbGUtdGltZSB2YWx1ZSBkZWZpbmVkIE1ZU1FMX1BPUlQgKGluIHRoYXQgb3JkZXIpLiAgV2luMzIgd2lsbCBvbmx5IGxvb2sKOyBhdCBNWVNRTF9QT1JULgo7IGh0dHA6Ly9waHAubmV0L215c3FsaS5kZWZhdWx0LXBvcnQ=",
                "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");
        try {
            assertTrue(kalkanService.certInfo(req) != null);
        } catch (Exception e) {
            log.error("error: ", e);
        }
    }
}
